(function(t,r){var e="object"==typeof exports&&exports&&("object"==typeof t&&t&&t==t.global&&(window=t),exports);"function"==typeof define&&define.amd?define(["Ix","exports"],function(e,n){return t.Ix=r(t,n,e),t.Ix}):"object"==typeof module&&module&&module.exports==e?module.exports=r(t,module.exports,require("./l2o")):t.Ix=r(t,{},t.Ix)})(this,function(t,r,e){function n(){}function u(t){return t}function i(t,r){return t>r?1:r>t?-1:0}function o(t,r){return t===r}function f(t,r){r||(r=o);for(var e=0,n=this.length;n>e;e++)if(r(t,this[e]))return e;return-1}function s(t,r,e){var n=[],u=t.getEnumerator();try{if(!u.moveNext())throw Error(m);var i=u.getCurrent(),o=r(i);for(n.push(i);u.moveNext();){var f=u.getCurrent(),s=r(f),c=e(s,o);0===c?n.push(f):c>0&&(n=[f],o=s)}}finally{u.dispose()}return x(n)}function c(t){this.readerCount=t,this.list={},this.length=0}function a(){this.list=[],this.length=0}function h(t,r){return function(){t.apply(r,arguments)}}function l(t,r){var e=this;return new y(function(){var n,u,i=t;return b(function(){if(u||(u=e.getEnumerator()),!u.moveNext())return!1;var t=u.getCurrent();return i=r(i,t),n=i,!0},function(){return n},function(){u&&u.dispose()})})}function v(t){var r=this;return new y(function(){var e,n,u,i=!1;return b(function(){for(n||(n=r.getEnumerator());;){if(!n.moveNext())return!1;var o=n.getCurrent();{if(i)return u=t(u,o),e=u,!0;i=!0,u=o}}},function(){return e},function(){n&&n.dispose()})})}function g(t,r){return new y(function(){var e,n,u;return b(function(){for(o||(o=t.getEnumerator());;){var n,i;try{n=o.moveNext(),i=o.getCurrent()}catch(o){u=r(o);break}return n?(e=i,!0):!1}return u?(o.dispose(),o=u.getEnumerator(),o.moveNext()?(e=o.getCurrent(),!0):!1):undefined},function(){return e},function(){n&&n.dispose()})})}var m="Sequence contains no elements.",p=Array.prototype.slice,y=e.Enumerable,d=y.prototype,E=y.concat,w=y.empty,x=y.fromArray,C=y.repeat,b=e.Enumerator.create;inherits=e.Internals.inherits,d.isEmpty=function(){return!this.any()},d.minBy=function(t,r){return r||(r=i),s(this,t,function(t,e){return-r(t,e)})},d.maxBy=function(t,r){return r||(r=i),s(this,t,r)};var N=function(){function t(t){this.disposed=!1,this.source=t}return inherits(t,y),t.prototype.getEnumerator=function(){if(this.disposed)throw Error("Object disposed");var t,r=this;return b(function(){return r.source.moveNext()?(t=r.source.getCurrent(),!0):!1},function(){return t})},t.prototype.dispose=function(){this.disposed||(this.disposed=!0,this.source.dispose(),this.source=null)},t}();d.share=function(t){var r=this;return t?new y(function(){return t(r.share()).getEnumerator()}):new N(r.getEnumerator())};var k=c.prototype;k.clear=function(){this.list={},this.length=0},k.get=function(t){if(!this.list[t])throw Error("Element no longer available in the buffer.");var r=this.list[t];return 0===--r.length&&delete this.list[t],r.value},k.push=function(t){this.list[this.length]={value:t,length:this.readerCount},this.length++},k.done=function(t){for(var r=t;this.length>r;r++)this.get(r);this.readerCount--};var D=function(){function t(t){this.source=t,this.buffer=new c(0),this.disposed=!1,this.stopped=!1,this.error=null}function r(t){var r,e=this,n=!1,u=!0,i=!1;return b(function(){if(e.disposed)throw Error("Object disposed");u||t++;var o,f=!1;if(t>=e.buffer.length){if(!e.stopped)try{f=e.source.moveNext(),f&&(o=e.source.getCurrent())}catch(s){e.stopped=!0,e.error=s,e.source.dispose(),n=!0}if(e.stopped){if(e.error)throw e.buffer&&e.buffer.done(t+1),i=!0,e.error;return e.buffer&&e.buffer.done(t+1),i=!0,!1}f&&e.buffer.push(o)}else f=!0;return f?(r=e.buffer.get(t),u=!1,!0):(e.buffer&&e.buffer.done(t+1),i=!0,!1)},function(){return r},function(){i&&e.buffer&&e.buffer.done(t)})}return inherits(t,y),t.prototype.getEnumerator=function(){if(this.disposed)throw Error("Object disposed");var t=this.buffer.length;return this.buffer.readerCount++,r.call(this,t)},t.prototype.dispose=function(){this.disposed||(this.source.dispose(),this.source=null,this.buffer.clear(),this.buffer=null,this.disposed=!0)},t}();d.publish=function(t){var r=this;return t?new y(function(){return t(r.publish()).getEnumerator()}):new D(r.getEnumerator())};var z=a.prototype;z.done=n,z.push=function(t){this.list[this.length++]=t},z.clear=function(){this.list=[],this.length=0},z.get=function(t){return this.list[t]};var A=function(){function t(t,r){this.source=t,this.buffer=r,this.stopped=!1,this.error=null,this.disposed=!1}return inherits(t,y),t.prototype.getEnumerator=function(){if(this.disposed)throw Error("Object disposed");var t,r=0,e=this,n=!1,u=!0,i=!1;return b(function(){if(e.disposed)throw Error("Object disposed");u||r++;var o,f=!1;if(r>=e.buffer.length){if(!e.stopped)try{f=e.source.moveNext(),f&&(o=e.source.getCurrent())}catch(s){e.stopped=!0,e.error=s,e.source.dispose(),n=!0}if(e.stopped){if(e.error)throw e.buffer&&e.buffer.done(r+1),i=!0,e.error;return e.buffer&&e.buffer.done(r+1),i=!0,!1}f&&e.buffer.push(o)}else f=!0;return f?(t=e.buffer.get(r),u=!1,!0):(e.buffer&&e.buffer.done(r+1),i=!0,!1)},function(){return t},function(){i&&e.buffer&&e.buffer.done(r)})},t.prototype.dispose=function(){this.disposed||(this.source.dispose(),this.source=null,this.buffer.clear(),this.buffer=null,this.disposed=!0)},t}();d.memoize=function(){var t=this;return 0===arguments.length?new A(t.getEnumerator(),new a):1===arguments.length&&"function"==typeof arguments[0]?new y(function(){return arguments[1](t.memoize()).getEnumerator()}):1===arguments.length&&"number"==typeof arguments[0]?new A(t.getEnumerator(),new c(arguments[0])):new y(function(){return arguments[1](t.memoize(arguments[0])).getEnumerator()})},y.throwException=function(t){return new y(function(){return b(function(){throw t},n)})};var P=y.defer=function(t){return new y(function(){var r;return b(function(){return r||(r=t().getEnumerator()),r.moveNext()},function(){return r.getCurrent()},function(){r.dispose()})})};y.generate=function(t,r,e,n){return new y(function(){var u,i,o=!1;return b(function(){if(o){if(u=e(u),!r(u))return!1}else u=t,o=!0;return i=n(u),!0},function(){return i})})},y.using=function(t,r){return new y(function(){var e,n,u,i=!0;return b(function(){return i&&(u=t(),n=r(u).getEnumerator(),i=!1),n.moveNext()?(e=n.getCurrent(),!0):!1},function(){return e},function(){n&&n.dispose(),u&&u.dispose()})})},d.doAction=function(t,r,e){var u,i,o,f=this;return"object"==typeof t?(u=h(t.onNext,t),i=h(t.onError,t),o=h(t.onCompleted,t)):(u=t,i=r||n,o=e||n),new y(function(){var t,r;return b(function(){t||(t=f.getEnumerator());try{if(!t.moveNext())return o(),!1;r=t.getCurrent()}catch(t){throw i(t),t}return u(r),!0},function(){return r},function(){t&&t.dispose()})})},d.bufferWithCount=function(t,r){var e=this;return null==r&&(r=t),new y(function(){var n,u,i=[],o=0;return b(function(){for(n||(n=e.getEnumerator());;){if(!n.moveNext())return i.length>0?(u=y.fromArray(i.shift()),!0):!1;0===o%r&&i.push([]);for(var f=0,s=i.length;s>f;f++)i[f].push(n.getCurrent());if(i.length>0&&i[0].length===t)return u=y.fromArray(i.shift()),++o,!0;++o}},function(){return u},function(){n.dispose()})})},d.ignoreElements=function(){var t=this;return new y(function(){var r;return b(function(){for(r=t.getEnumerator();r.moveNext(););return!1},function(){throw Error("Operation is not valid due to the current state of the object.")},function(){r.dispose()})})},d.distinctBy=function(t,r){r||(r=o);var e=this;return new y(function(){var n,u,i=[];return b(function(){for(u||(u=e.getEnumerator());;){if(!u.moveNext())return!1;var o=u.getCurrent(),s=t(o);if(-1===f.call(i,s,r))return i.push(o),n=o,!0}},function(){return n},function(){u&&u.dispose()})})},d.distinctUntilChanged=function(t,r){t||(t=u),r||(r=o);var e=this;return new y(function(){var n,u,i,o;return b(function(){for(u||(u=e.getEnumerator());;){if(!u.moveNext())return!1;var f=u.getCurrent(),s=t(f),c=!1;if(o&&(c=r(i,s)),!o||!c)return n=f,i=s,o=!0,!0}},function(){return n},function(){u&&u.dispose()})})},d.expand=function(t){var r=this;return new y(function(){var e,n,u=[r];return b(function(){for(;;){if(!n){if(0===u.length)return!1;n=u.shift().getEnumerator()}if(n.moveNext())return e=n.getCurrent(),u.push(t(e)),!0;n.dispose(),n=null}},function(){return e},function(){n&&n.dispose()})})},d.startWith=function(){return E(x(p.call(arguments)),this)},d.scan=function(){var t=1===arguments.length?v:l;return t.apply(this,arguments)},d.takeLast=function(t){var r=this;return new y(function(){var e,n,u;return b(function(){if(n||(n=r.getEnumerator()),!u)for(u=[];n.moveNext();)u.push(n.getCurrent()),u.length>t&&u.shift();return 0===u.length?!1:(e=u.shift(),!0)},function(){return e},function(){n&&n.dispose()})})},d.skipLast=function(t){var r=this;return new y(function(){var e,n,u=[];return b(function(){for(n||(n=r.getEnumerator());;){if(!n.moveNext())return!1;if(u.push(n.getCurrent()),u.length>t)return e=u.shift(),!0}},function(){return e},function(){n&&n.dispose()})})},d.repeat=function(t){var r=this;return C(0,t).selectMany(function(){return r})},d.catchException=function(t){if(0===arguments.length)return j(this);if("function"==typeof t)return g(this,t);var r=p.call(arguments);return r.unshift(this),j.apply(null,r)};var j=y.catchException=function(){var t=y.fromArray(arguments);return new y(function(){var r,e,n,u;return b(function(){for(r||(r=t.getEnumerator());;){for(;;){if(!e){if(!r.moveNext()){if(u)throw u;return!1}u=null,e=r.getCurrent().getEnumerator()}var i,o;try{i=e.moveNext(),o=e.getCurrent()}catch(f){u=f,e.dispose(),e=null;break}if(!i){e.dispose(),e=null;break}return n=o,!0}if(null==u)break}},function(){return n},function(){e&&e.dispose(),r&&r.dispose()})})};d.finallyDo=function(t){var r=this;return new y(function(){var e,n=!1;return b(function(){u||(u=r.getEnumerator());var e;try{return e=u.moveNext(),e?e:(t(),n=!0,!1)}catch(u){throw t(),n=!0,u}},function(){return e.getCurrent()},function(){!n&&t(),e&&e.dispose()})})},d.onErrorResumeNext=function(t){return O.apply(null,[this,t])};var O=y.onErrorResumeNext=function(){var t=arguments;return new y(function(){var r,e,n=0;return b(function(){for(;t.length>n;){e||(e=t[n].getEnumerator());try{var u=e.moveNext();if(u)return r=e.getCurrent(),!0}catch(i){}e.dispose(),e=null,n++}return!1},function(){return r},function(){e&&e.dispose()})})};d.retry=function(t){var r=this;return new y(function(){var e,n,u=t,i=null!=t;return b(function(){for(n||(n=r.getEnumerator());;)try{return n.moveNext()?(e=n.getCurrent(),!0):!1}catch(t){if(i&&0===--u)throw t;n=r.getEnumerator(),error=null}},function(){return e},function(){n.dispose()})})};var q=y.whileDo=function(t,r){return C(r).takeWhile(t).selectMany(u)};return y.ifThen=function(t,r,e){return e||(e=w()),P(function(){return t()?r:e})},y.doWhile=function(t,r){return t.concat(q(r,t))},y.cases=function(t,r,e){return e||(e=w()),P(function(){var n=r[t()];return n||(n=e),n})},y.forIn=function(t,r){return t.select(r)},e});